generator client {
  provider = "prisma-client"
  output   = "../generated/prisma-client"
}

generator prismabox { 
  provider = "prismabox"
  typeboxImportDependencyName = "elysia"
  typeboxImportVariableName = "t"
  inputModel = true
  output   = "../generated/prismabox"
} 

datasource db {
  provider = "postgresql"
}

model Consultation {
  id        Int        @id @default(autoincrement())
  userId    Int
  doctorId  Int
  date      String
  notes     String
  createdAt DateTime   @default(now())
  updatedAt String?
  doctor    Doctor     @relation(fields: [doctorId], references: [id])
  user      User       @relation(fields: [userId], references: [id])
  referrals Referral[]
}

model Doctor {
  id            Int            @id @default(autoincrement())
  firstName     String
  lastName      String
  speciality    String
  phoneNumber   String         @unique
  birthDate     String
  email         String         @unique
  password      String
  crm           String         @unique
  cpf           String         @unique
  role          Role           @default(doctor)
  createdAt     DateTime       @default(now())
  updatedAt     String?
  consultations Consultation[]
}

model Referral {
  id             Int          @id @default(autoincrement())
  notes          String
  consultationId Int
  createdAt      DateTime     @default(now())
  updatedAt      String?
  consultation   Consultation @relation(fields: [consultationId], references: [id])
}

model User {
  id            Int            @id @default(autoincrement())
  firstName     String 
  lastName      String
  phoneNumber   String         @unique
  email         String         @unique
  cpf           String         @unique
  birthDate     String
  password      String
  createdAt     DateTime       @default(now())
  updatedAt     String?
  role          String         @default("user")
  consultations Consultation[]
}

enum Role {
  doctor
  admin
}
